# hello, i made those changes and then reran, here are my results. what do you make of these?

# === Training on Task 0 ===
# CLASSES FOR TASK 0: [0, 1]
# Task 0:   0%|                                                                                                        | 0/250 [00:00<?, ?batch/s][CWR] preload first call, present: [0, 1]
# [mini pre] tb (pre-step): [0.0, 0.0]  cb (pre): [0.0, 0.0]
# [logit mag] pos|neg ~ 0.0 | 0.0
# [mini] tw norms %  : [50.0, 50.0]
# [mini] cw norms %  : [0.0, 0.0]
# [count/batch t=0 e=0 s=0] {0: 12, 1: 28}
# [CWR] consolidate first call: classes: [0, 1] counts: [1.0, 1.0]
# Task 0:  40%|█████████████████████████████████▏                                                 | 100/250 [01:18<01:56,  1.29batch/s, loss=2.74][mini pre] tb (pre-step): [0.0, 0.0]  cb (pre): [0.0, 0.0]
# [logit mag] pos|neg ~ 4.4 | 2.7
# [mini] tw norms %  : [50.0, 50.0]
# [mini] cw norms %  : [50.0, 50.0]
# [count/batch t=0 e=0 s=100] {0: 20, 1: 20}
# Task 0:  80%|██████████████████████████████████████████████████████████████████▍                | 200/250 [02:37<00:40,  1.22batch/s, loss=4.91][mini pre] tb (pre-step): [0.0, 0.0]  cb (pre): [0.0, 0.0]
# [logit mag] pos|neg ~ 3.5 | 4.1
# [mini] tw norms %  : [50.0, 50.0]
# [mini] cw norms %  : [50.0, 50.0]
# [count/batch t=0 e=0 s=200] {0: 20, 1: 20}
# Task 0: 100%|███████████████████████████████████████████████████████████████████████████████████| 250/250 [03:18<00:00,  1.26batch/s, loss=3.66]
# [t=0] prev_seen=[] task=[0, 1] seen_so_far=[0, 1]... (len=2)

# === Evaluating on Task 0 ===
# [Task 0] present class hits: {0: 250, 1: 250}
# [Task 0] hist_count delta: [250, 250, 0, 0, 0, 0, 0, 0, 0, 0]
# [Task 0] acc: 0.806
# [Task 0] Prediction Labels: {0: 1032, 1: 968}
# [Task 0] True Labels: {0: 1000, 1: 1000}
# [Task 0] per-class acc: {0: 0.822, 1: 0.79}
# [CWR after task 0] hist_count (first 10): [250, 250, 0, 0, 0, 0, 0, 0, 0, 0]
# [CWR after task 0] cw norms   (first 10): [0.9999999403953552, 0.9999999403953552, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [CWR after task 0] top-norm classes: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
# [CWR after task 0] low-norm classes: [5, 8, 2, 3, 4, 9, 6, 7, 1, 0]

# === Training on Task 1 ===
# CLASSES FOR TASK 1: [2, 3]
# Task 1:   0%|                                                                                                        | 0/250 [00:00<?, ?batch/s][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 1.9 | 1.5
# [mini] tw norms %  : [25.0, 25.0, 25.0, 25.0]
# [mini] cw norms %  : [50.0, 50.0, 0.0, 0.0]
# [count/batch t=1 e=0 s=0] {0: 20, 1: 20, 2: 20, 3: 20}
# Task 1:  40%|█████████████████████████████████▏                                                 | 100/250 [02:31<03:37,  1.45s/batch, loss=7.14][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 2.9 | 3.8
# [mini] tw norms %  : [25.0, 25.0, 25.0, 25.0]
# [mini] cw norms %  : [25.0, 25.0, 25.0, 25.0]
# [count/batch t=1 e=0 s=100] {0: 20, 1: 20, 2: 15, 3: 25}
# Task 1:  59%|█████████████████████████████████████████████████▏                                 | 148/250 [04:21<09:33,  5.62s/baTask 1:  60%|█████████████████████████████████████████████████▍                                 | 149/250 [04:21<10:40,  6.34s/baTask 1:  80%|██████████████████████████████████████████████████████████████████▍                | 200/250 [07:04<01:54,  2.30s/batch, loss=6.54][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 4.0 | 2.1
# [mini] tw norms %  : [25.0, 25.0, 25.0, 25.0]
# [mini] cw norms %  : [25.0, 25.0, 25.0, 25.0]
# [count/batch t=1 e=0 s=200] {0: 40, 1: 40, 2: 22, 3: 18}
# Task 1: 100%|███████████████████████████████████████████████████████████████████████████████████| 250/250 [08:59<00:00,  2.16s/batch, loss=6.81]
# [t=1] prev_seen=[0, 1] task=[2, 3] seen_so_far=[0, 1, 2, 3]... (len=4)

# === Evaluating on Task 1 ===
# [Task 1] present class hits: {0: 250, 1: 250, 2: 250, 3: 250}
# [Task 1] hist_count delta: [250, 250, 250, 250, 0, 0, 0, 0, 0, 0]
# [Task 0] acc: 0.395
# [Task 0] Prediction Labels: {0: 642, 1: 235, 2: 687, 3: 436}
# [Task 0] True Labels: {0: 1000, 1: 1000}
# [Task 0] per-class acc: {0: 0.57, 1: 0.22}
# [Task 1] acc: 0.467
# [Task 1] Prediction Labels: {0: 471, 1: 132, 2: 807, 3: 590}
# [Task 1] True Labels: {2: 1000, 3: 1000}
# [Task 1] per-class acc: {2: 0.498, 3: 0.436}
# [CWR after task 1] hist_count (first 10): [500, 500, 250, 250, 0, 0, 0, 0, 0, 0]
# [CWR after task 1] cw norms   (first 10): [1.0, 0.9999999403953552, 1.0, 1.0000001192092896, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [CWR after task 1] top-norm classes: [3, 0, 2, 1, 4, 5, 6, 7, 8, 9]
# [CWR after task 1] low-norm classes: [5, 8, 7, 6, 4, 9, 1, 2, 0, 3]

# === Training on Task 2 ===
# CLASSES FOR TASK 2: [4, 5]
# Task 2:   0%|                                                                                                                                | 0/250 [00:00<?, ?batch/s][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 1.0 | 1.3
# [mini] tw norms %  : [16.67, 16.67, 16.67, 16.67, 16.67, 16.67]
# [mini] cw norms %  : [25.0, 25.0, 25.0, 25.0, 0.0, 0.0]
# [count/batch t=2 e=0 s=0] {0: 12, 1: 12, 2: 8, 3: 8, 4: 19, 5: 21}
# Task 2:  40%|██████████████████████████████████████████▊                                                                | 100/250 [02:30<03:56,  1.58s/batch, loss=8.54][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 5.1 | 2.5
# [mini] tw norms %  : [16.67, 16.67, 16.67, 16.67, 16.67, 16.67]
# [mini] cw norms %  : [16.67, 16.67, 16.67, 16.67, 16.67, 16.67]
# [count/batch t=2 e=0 s=100] {0: 12, 1: 12, 2: 8, 3: 8, 4: 19, 5: 21}
# Task 2:  80%|█████████████████████████████████████████████████████████████████████████████████████▌                     | 200/250 [06:16<01:58,  2.37s/batch, loss=7.34][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 5.2 | 2.1
# [mini] tw norms %  : [16.67, 16.67, 16.67, 16.67, 16.67, 16.67]
# [mini] cw norms %  : [16.67, 16.67, 16.67, 16.67, 16.67, 16.67]
# [count/batch t=2 e=0 s=200] {0: 24, 1: 24, 2: 16, 3: 16, 4: 26, 5: 14}
# Task 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [08:10<00:00,  1.96s/batch, loss=7.52]
# [t=2] prev_seen=[0, 1, 2, 3] task=[4, 5] seen_so_far=[0, 1, 2, 3, 4, 5]... (len=6)

# === Evaluating on Task 2 ===
# [Task 2] present class hits: {0: 250, 1: 250, 2: 250, 3: 250, 4: 250, 5: 250}
# [Task 2] hist_count delta: [250, 250, 250, 250, 250, 250, 0, 0, 0, 0]
# [Task 0] acc: 0.443
# [Task 0] Prediction Labels: {0: 595, 1: 487, 2: 159, 3: 89, 4: 29, 5: 641}
# [Task 0] True Labels: {0: 1000, 1: 1000}
# [Task 0] per-class acc: {0: 0.47, 1: 0.416}
# [Task 1] acc: 0.151
# [Task 1] Prediction Labels: {0: 325, 1: 476, 2: 301, 3: 120, 4: 100, 5: 678}
# [Task 1] True Labels: {2: 1000, 3: 1000}
# [Task 1] per-class acc: {2: 0.216, 3: 0.087}
# [Task 2] acc: 0.313
# [Task 2] Prediction Labels: {0: 241, 1: 484, 2: 296, 3: 143, 4: 161, 5: 675}
# [Task 2] True Labels: {4: 1000, 5: 1000}
# [Task 2] per-class acc: {4: 0.127, 5: 0.499}
# [CWR after task 2] hist_count (first 10): [750, 750, 500, 500, 250, 250, 0, 0, 0, 0]
# [CWR after task 2] cw norms   (first 10): [1.0, 1.0, 1.0, 1.0000001192092896, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0]
# [CWR after task 2] top-norm classes: [3, 1, 2, 0, 4, 5, 6, 7, 8, 9]
# [CWR after task 2] low-norm classes: [9, 8, 7, 6, 4, 0, 2, 1, 5, 3]

# === Training on Task 3 ===
# CLASSES FOR TASK 3: [6, 7]
# Task 3:   0%|                                                                                                                                | 0/250 [00:00<?, ?batch/s][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 1.0 | 1.2
# [mini] tw norms %  : [12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5]
# [mini] cw norms %  : [16.67, 16.67, 16.67, 16.67, 16.67, 16.67, 0.0, 0.0]
# [count/batch t=3 e=0 s=0] {0: 6, 1: 6, 2: 6, 3: 6, 4: 8, 5: 8, 6: 19, 7: 21}
# Task 3:  40%|██████████████████████████████████████████▊                                                                | 100/250 [02:32<03:45,  1.50s/batch, loss=8.06][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 5.5 | 1.6
# [mini] tw norms %  : [12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5]
# [mini] cw norms %  : [12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5]
# [count/batch t=3 e=0 s=100] {0: 6, 1: 6, 2: 6, 3: 6, 4: 8, 5: 8, 6: 19, 7: 21}
# Task 3:  80%|██████████████████████████████████████████████████████████████████████████████████████▍                     | 200/250 [05:57<01:56,  2.33s/batch, loss=8.2][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 4.9 | 1.3
# [mini] tw norms %  : [12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5]
# [mini] cw norms %  : [12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5]
# [count/batch t=3 e=0 s=200] {0: 12, 1: 12, 2: 12, 3: 12, 4: 16, 5: 16, 6: 23, 7: 17}
# Task 3:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 245/250 [07:40<00:12,  2.49s/batch, loss=8.09]Task 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [07:52<00:00,  1.89s/batch, loss=7.91]
# [t=3] prev_seen=[0, 1, 2, 3, 4, 5] task=[6, 7] seen_so_far=[0, 1, 2, 3, 4, 5, 6, 7]... (len=8)

# === Evaluating on Task 3 ===
# [Task 3] present class hits: {0: 250, 1: 250, 2: 250, 3: 250, 4: 250, 5: 250, 6: 250, 7: 250}
# [Task 3] hist_count delta: [250, 250, 250, 250, 250, 250, 250, 250, 0, 0]
# [Task 0] acc: 0.273
# [Task 0] Prediction Labels: {0: 535, 1: 125, 2: 89, 3: 75, 4: 219, 5: 263, 6: 48, 7: 646}
# [Task 0] True Labels: {0: 1000, 1: 1000}
# [Task 0] per-class acc: {0: 0.434, 1: 0.111}
# [Task 1] acc: 0.093
# [Task 1] Prediction Labels: {0: 512, 1: 122, 2: 83, 3: 174, 4: 331, 5: 292, 6: 187, 7: 299}
# [Task 1] True Labels: {2: 1000, 3: 1000}
# [Task 1] per-class acc: {2: 0.055, 3: 0.132}
# [Task 2] acc: 0.257
# [Task 2] Prediction Labels: {0: 486, 1: 93, 2: 85, 3: 177, 4: 374, 5: 275, 6: 234, 7: 276}
# [Task 2] True Labels: {4: 1000, 5: 1000}
# [Task 2] per-class acc: {4: 0.299, 5: 0.214}
# [Task 3] acc: 0.216
# [Task 3] Prediction Labels: {0: 363, 1: 151, 2: 128, 3: 158, 4: 376, 5: 227, 6: 300, 7: 297}
# [Task 3] True Labels: {6: 1000, 7: 1000}
# [Task 3] per-class acc: {6: 0.224, 7: 0.208}
# [CWR after task 3] hist_count (first 10): [1000, 1000, 750, 750, 500, 500, 250, 250, 0, 0]
# [CWR after task 3] cw norms   (first 10): [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9999999403953552, 1.0, 0.0, 0.0]
# [CWR after task 3] top-norm classes: [0, 1, 2, 3, 4, 5, 7, 6, 8, 9]
# [CWR after task 3] low-norm classes: [9, 8, 6, 3, 4, 0, 2, 7, 1, 5]

# === Training on Task 4 ===
# CLASSES FOR TASK 4: [8, 9]
# Task 4:   0%|                                                                                                                                | 0/250 [00:00<?, ?batch/s][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 0.8 | 1.1
# [mini] tw norms %  : [10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0]
# [mini] cw norms %  : [12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 12.5, 0.0, 0.0]
# [count/batch t=4 e=0 s=0] {0: 4, 1: 4, 2: 4, 3: 4, 4: 4, 5: 4, 6: 8, 7: 8, 8: 15, 9: 25}
# Task 4:  40%|██████████████████████████████████████████▊                                                                | 100/250 [02:30<03:43,  1.49s/batch, loss=8.01][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 4.7 | 1.6
# [mini] tw norms %  : [10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0]
# [mini] cw norms %  : [10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0]
# [count/batch t=4 e=0 s=100] {0: 4, 1: 4, 2: 4, 3: 4, 4: 4, 5: 4, 6: 8, 7: 8, 8: 21, 9: 19}
# Task 4:  80%|█████████████████████████████████████████████████████████████████████████████████████▌                     | 200/250 [05:56<01:49,  2.19s/batch, loss=8.18][mini pre] tb (pre-step): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]  cb (pre): [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
# [logit mag] pos|neg ~ 4.9 | 1.3
# [mini] tw norms %  : [10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0]
# [mini] cw norms %  : [10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0]
# [count/batch t=4 e=0 s=200] {0: 8, 1: 8, 2: 8, 3: 8, 4: 8, 5: 8, 6: 16, 7: 16, 8: 21, 9: 19}
# Task 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 250/250 [07:46<00:00,  1.87s/batch, loss=8.18]
# [t=4] prev_seen=[0, 1, 2, 3, 4, 5, 6, 7] task=[8, 9] seen_so_far=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]... (len=10)

# === Evaluating on Task 4 ===
# [Task 4] present class hits: {0: 250, 1: 250, 2: 250, 3: 250, 4: 250, 5: 250, 6: 250, 7: 250, 8: 250, 9: 250}
# [Task 4] hist_count delta: [250, 250, 250, 250, 250, 250, 250, 250, 250, 250]
# [Task 0] acc: 0.239
# [Task 0] Prediction Labels: {0: 402, 1: 171, 2: 101, 3: 75, 4: 141, 5: 149, 6: 117, 7: 136, 8: 302, 9: 406}
# [Task 0] True Labels: {0: 1000, 1: 1000}
# [Task 0] per-class acc: {0: 0.34, 1: 0.139}
# [Task 1] acc: 0.073
# [Task 1] Prediction Labels: {0: 340, 1: 170, 2: 124, 3: 102, 4: 220, 5: 157, 6: 299, 7: 25, 8: 203, 9: 360}
# [Task 1] True Labels: {2: 1000, 3: 1000}
# [Task 1] per-class acc: {2: 0.071, 3: 0.075}
# [Task 2] acc: 0.131
# [Task 2] Prediction Labels: {0: 327, 1: 135, 2: 157, 3: 121, 4: 200, 5: 157, 6: 318, 7: 23, 8: 253, 9: 309}
# [Task 2] True Labels: {4: 1000, 5: 1000}
# [Task 2] per-class acc: {4: 0.135, 5: 0.127}
# [Task 3] acc: 0.115
# [Task 3] Prediction Labels: {0: 207, 1: 191, 2: 195, 3: 126, 4: 203, 5: 120, 6: 331, 7: 23, 8: 218, 9: 386}
# [Task 3] True Labels: {6: 1000, 7: 1000}
# [Task 3] per-class acc: {6: 0.211, 7: 0.019}
# [Task 4] acc: 0.220
# [Task 4] Prediction Labels: {0: 453, 1: 157, 2: 80, 3: 137, 4: 138, 5: 168, 6: 86, 7: 143, 8: 233, 9: 405}
# [Task 4] True Labels: {8: 1000, 9: 1000}
# [Task 4] per-class acc: {8: 0.155, 9: 0.285}
# [CWR after task 4] hist_count (first 10): [1250, 1250, 1000, 1000, 750, 750, 500, 500, 250, 250]
# [CWR after task 4] cw norms   (first 10): [1.0, 1.0, 1.0, 1.0, 0.9999999403953552, 1.0, 1.0, 1.0, 0.9999999403953552, 1.0]
# [CWR after task 4] top-norm classes: [0, 1, 2, 3, 9, 5, 6, 7, 8, 4]
# [CWR after task 4] low-norm classes: [8, 4, 2, 3, 1, 5, 6, 7, 0, 9]

# = .778